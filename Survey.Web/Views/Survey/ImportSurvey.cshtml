@model Survey.Core.ViewModels.FormViewModel

@{
    ViewData["Title"] = "UploadCases";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<!--begin::Wrapper-->
<div class="d-flex flex-column flex-row-fluid wrapper" id="kt_wrapper">
    <!--begin::Content-->
    <div class="content d-flex flex-column flex-column-fluid" id="kt_content">
        <!--begin::Subheader-->
        <div class="subheader py-6 py-lg-8 subheader-transparent" id="kt_subheader">
            <div class="container d-flex align-items-center justify-content-between flex-wrap flex-sm-nowrap">
                <!--begin::Info-->
                <div class="d-flex align-items-center flex-wrap mr-1">
                    <!--begin::Page Heading-->
                    <div class="d-flex align-items-baseline flex-wrap mr-5">
                        <!--begin::Page Title-->
                        <h5 class="text-dark font-weight-bold my-1 mr-5">Survey</h5>
                        <!--end::Page Title-->
                        <!--begin::Breadcrumb-->
                        <ul class="breadcrumb breadcrumb-transparent breadcrumb-dot font-weight-bold p-0 my-2 font-size-sm">
                            <li class="breadcrumb-item text-muted">
                                <a class="text-muted" href="/Survey/ManageForm">Manage Survey</a>
                            </li>
                            <li class="breadcrumb-item text-muted">
                                <a href="" class="text-muted">
                                    Upload the survey file
                                </a>
                            </li>

                        </ul>
                        <!--end::Breadcrumb-->
                    </div>
                    <!--end::Page Heading-->
                </div>
                <!--end::Info-->
            </div>
        </div>
        <!--end::Subheader-->
        <!--begin::Entry-->
        <div class="d-flex flex-column-fluid">
            <!--begin::Container-->
            <div class="container">
                <div class="card card-custom gutter-b" style="background-color:#404040;">
                    <div class="card-body d-flex align-items-center py-5 py-lg-15">
                        <!--begin::Icon-->
                        <div class="d-flex flex-center position-relative ml-5 mr-15 ml-lg-9">
                            <span class="svg-icon svg-icon-5x svg-icon-orange position-absolute opacity-15">
                                <!--begin::Svg Icon | path:assets/media/svg/icons/Layout/Layout-polygon.svg-->
                                <svg xmlns="http://www.w3.org/2000/svg" width="70px" height="70px" viewBox="0 0 70 70" fill="none">
                                    <g stroke="none" stroke-width="1" fill-rule="evenodd">
                                        <path d="M28 4.04145C32.3316 1.54059 37.6684 1.54059 42 4.04145L58.3109 13.4585C62.6425 15.9594 65.3109 20.5812 65.3109 25.5829V44.4171C65.3109 49.4188 62.6425 54.0406 58.3109 56.5415L42 65.9585C37.6684 68.4594 32.3316 68.4594 28 65.9585L11.6891 56.5415C7.3575 54.0406 4.68911 49.4188 4.68911 44.4171V25.5829C4.68911 20.5812 7.3575 15.9594 11.6891 13.4585L28 4.04145Z" fill="#000000" />
                                    </g>
                                </svg>
                                <!--end::Svg Icon-->
                            </span>
                            <span class="svg-icon svg-icon-orange svg-icon-2x">
                                <!--begin::Svg Icon | path:/var/www/preview.keenthemes.com/keen/releases/2021-04-21-040700/theme/demo1/dist/../src/media/svg/icons/Code/Info-circle.svg--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
                                    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                        <rect x="0" y="0" width="24" height="24" />
                                        <circle fill="#000000" opacity="0.3" cx="12" cy="12" r="10" />
                                        <rect fill="#000000" x="11" y="10" width="2" height="7" rx="1" />
                                        <rect fill="#000000" x="11" y="7" width="2" height="2" rx="1" />
                                    </g>
                                </svg><!--end::Svg Icon-->
                            </span>
                        </div>
                        <!--end::Icon-->
                        <!--begin::Description-->
                        <div class="m-0 text-white font-size-md">
                            <p class="mb-0">Upload your survey in xls format below. Note that this function is suitable for updating content in surveys that have already been exported as xls files.</p>
                        </div>
                        <!--end::Description-->
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-10 col-lg-12 center-block">
                        <!--begin::Card-->
                        <div class="card card-custom gutter-b example-compact">

                            <!--begin::Form-->
                            <form  method="post" enctype="multipart/form-data" id="mainform">
                                <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                                <div class="card-body">
                                    <div class="form-group mb-8">
                                        <div class="card-header">
                                            <h4 class="card-label">
                                                <svg aria-hidden="true" style="margin-right:10px;" focusable="false" width="32" height="32" viewBox="0 0 32 32"><g fill="none" fillRule="evenodd"><rect class="uppy-ProviderIconBg" width="32" height="32" rx="16" fill="#3F4254"></rect><path d="M21.973 21.152H9.863l-1.108-5.087h14.464l-1.246 5.087zM9.935 11.37h3.958l.886 1.444a.673.673 0 0 0 .585.316h6.506v1.37H9.935v-3.13zm14.898 3.44a.793.793 0 0 0-.616-.31h-.978v-2.126c0-.379-.275-.613-.653-.613H15.75l-.886-1.445a.673.673 0 0 0-.585-.316H9.232c-.378 0-.667.209-.667.587V14.5h-.782a.793.793 0 0 0-.61.303.795.795 0 0 0-.155.663l1.45 6.633c.078.36.396.618.764.618h13.354c.36 0 .674-.246.76-.595l1.631-6.636a.795.795 0 0 0-.144-.675z" fill="#FFF"></path></g></svg>
                                                Upload The Survey File
                                            </h4>
                                        </div>
                                    </div>


                                    <div class="row" style=" padding: 1rem 2.25rem;">
                                        <label class="col-lg-2 col-form-label" for="exampleSelect1">Upload The Survey File</label>
                                        <div class="col-md-3 col-lg-2 custom-file file-input1">
                                            <input type="file" id="fileupload" accept=".xlsx" asp-for="Excel" class="form-control file btn-orange" />
                                            <label for="fileupload">
                                                Select file
                                            </label>
                                        </div>
                                       
                                  
                                    </div>
                                    <div >
                                 <div class="form-group row" style=" padding: 1rem 2.25rem;">
                                   <label class="col-lg-2 col-form-label" for="exampleSelect1">Select Project or Activity</label>
                                   <div class="col-md-4 col-lg-4" style=" padding-right: 10px; ">
                                      <div class="dropdown bootstrap-select form-control">
                                         <select asp-for="ProjectId" class="form-control selectpicker" id="exampleSelect1" data-live-search="true" required="">
                                            <option disabled="" selected="">--Select Project or Activity--</option>
                                            @foreach(var pro in Model.ProjectList)
                                            {
                                                    <option value="@pro.Id">@pro.Title</option>        
                                             }
                                             </select>
                                          
                                         <div class="dropdown-menu ">
                                            <div class="bs-searchbox"><input type="search" class="form-control" autocomplete="off" role="combobox" aria-label="Search" aria-controls="bs-select-1" aria-autocomplete="list"></div>
                                            <div class="inner show" role="listbox" id="bs-select-1" tabindex="-1">
                                               <ul class="dropdown-menu inner show" role="presentation"></ul>
                                            </div>
                                         </div>
                                      </div>
                                   </div>
                                   <div class="col-lg-1 text-left" style="padding-left:0px;">
                                      <button style=" padding: 0.65rem 0.45rem 0.65rem 0.8rem;" type="button" class="btn btn-light" data-toggle="tooltip" data-html="true" title="" data-original-title="Please note that in the drop down box on the left you will only be able to see projects you have registered under the 'project' page.  ">
                                      <i class="fa flaticon2-information"></i>
                                      </button>
                                   </div>
                                </div>
                                    </div>
                                    <div class="row" style=" padding: 0rem 2.25rem;">
                                        <div class="col-lg-2"></div>
                                        <div class="file-name col-lg-4"></div>
                                    </div>
                                    <div class="row">
                                        <div class="col-lg-12 pt-10" id="divPrint"></div>
                                    </div>

                                    <div class="card-footer">
                                        <p style="color: red;text-align: center;" id="Errormessage"></p>

                                        <div class="row">
                                            <div class="col-lg-6">
                                                <button type="submit"  id="btnupload" class="btn btn-orange mr-2" >Save</button>
                                                <a asp-action="ManageForm" class="btn btn-secondary">Cancel</a>
                                            </div>
                                        </div>
                                    </div>
                            </form>
                            <!--end::Form-->
                        </div>
                        <!--end::Card-->
                    </div>
                </div>
            </div>
            <!--end::Container-->
        </div>
        <!--end::Entry-->
    </div>
    <!--end::Content-->

</div>
<!--end::Wrapper-->
@*@section Scripts {
        @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    }*@

<script type="text/javascript" src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script type="text/javascript" src="/js/ImportFormExcel.js"></script>

<style>

    .file {
        opacity: 0;
        width: 0.1px;
        height: 0.1px;
        position: absolute;
    }

    .file-input1 label {
        display: block;
        position: relative;
        padding: 0.65rem 1rem;
        width: 190px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #ED7D31;
        background-color: white;
        border: 1px solid #ED7D31;
        border-radius: .75rem;
        font-weight: 500;
        cursor: pointer;
        transition: transform .2s ease-out;
    }

    input:hover + label,
    input:focus + label {
        transform: scale(1.02);
    }


    .file-name {
        position: relative;
        font-size: 0.85rem;
        font-weight: 500;
        align-items: center;
        padding: .5rem 1rem;
        margin-top: .75rem;
        border-radius: .75rem;
        color: #7e8299;
    }

    .card.card-custom {
        box-shadow: 0px 0px 6px 0px rgb(82 63 105 / 18%);
        border: 0;
    }
</style> 